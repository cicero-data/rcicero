---
title: "Vignette for rcicero"
author: "David Ranzolin"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Vignette for rcicero}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Setup

If you have not done so already, [create an account here.](https://www.cicerodata.com/free-trial/) Creating an account is free, and you will be granted 1000 free credits (1 credit per query). Further use will require the purchase of additional credits.

You need three items to query the API: (1) a key; (2) a user id; and (3) a token. You can find your key in your account profile but must make a `POST` request to obtain your user id and token. 

Once you obtain your key, run:

```{r eval = FALSE}
library(rcicero)
set_token_and_user("your_account_email_address", "your_password")
```

```{r echo = FALSE}
library(rcicero)
set_token_and_user("kmreiber@gmail.com", "krist337$se")
```

Behind the scenes, `rcicero` stashes the `user` and `token` values into your global options. You must then add the `key` to your `.Renviron`, as `"CICERO_API_KEY"`. For help on setting up your .Renviron (and everything else R-related) see Jenny Bryan's [Stat545 page.](http://stat545.com/bit003_api-key-env-var.html)  Warning: the API token expires every 24 hours.

## Usage

Four functions make the bulk of `rcicero`: `get_legislative_district()`, `get_nonlegislative_district()`, `get_upcoming_elections()`, and `get_official()`. The first three return a `data_frame`, while `get_official()` returns a list of four data frames. Why? I thought it was easier and cleaner than coercing all the information into a single table. 

Here's a call to `get_legislative_district()`:

```{r message = FALSE, warning=FALSE}
library(dplyr)
ld <- get_legislative_district("3175 Bowers Ave. Santa Clara, CA")
ld %>% 
  filter(district_type == "STATE_LOWER") %>% 
  select(-address) %>% 
  knitr::kable()
```

Other `district_type`s include `"STATE_LOWER"`, `"STATE_UPPER"`, `"NATIONAL_LOWER"`, `"NATIONAL_UPPER"`, and `"NATIONAL_EXEC"`.

***

Here's a call to `get_nonlegislative_district()`:

```{r}
nld <- get_nonlegislative_district("3175 Bowers Ave. Santa Clara, CA", type = "SCHOOL")
nld %>% 
  select(-address) %>% 
  knitr::kable()
```

Other types include `"CENSUS"`, `"COUNTY"`, `"JUDICIAL"`, `"POLICE"`, and `"WATERSHED"`.

***

Here's a call to `get_upcoming_elections()`:

```{r}
upcoming_elections <- get_upcoming_elections(is_state = TRUE, elections = 6)
names(upcoming_elections)
head(upcoming_elections)
```

***

Here's a call to `get_official()`:

```{r}
jl <- get_official(first_name = "John", last_name = "Lewis")
class(jl)
lapply(jl, dim)
lapply(jl, names)
```


